<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">

    <link rel="icon" href="/practices/favicon.png">

    <meta property='og:image' content="https://devgeniem.github.io/practices/images/gdev-logo.png"/>
    <meta property='og:url' content="https://devgeniem.github.io/tyokalut/versionhallinta/">
    <link rel="image_src" href="https://devgeniem.github.io/practices/images/gdev-logo.png" / >
    <link rel="shortcut icon" href="https://devgeniem.github.io/practices/favicon.png">

    <title>Geniem Best Practices : Versionhallinta</title>
    <meta property='og:title' content="Geniem Best Practices : Versionhallinta"/>
    <meta property='og:site_name' content="Best Practices">
    <meta property="og:type" content="website" />

    
        <meta property='og:description' content="Pääperiaatteet

"/>
        <meta name='twitter:description' content="Pääperiaatteet

"/>
    

    <meta name="twitter:site" content="@Geniemfi">
    <meta name="summary" content="twitter:card">
    <meta name='twitter:title' content="Geniem Best Practices : Versionhallinta"/>
    <meta name="twitter:image:src" content="https://devgeniem.github.io/practices/images/gdev-logo.png">


    <meta name="description" content="Ohjeet hyvään kehitykseen">

    
    <meta name="google-site-verification" content="" />
    

    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>

    
    <script src="https://code.jquery.com/jquery-2.1.4.min.js" type="text/javascript"></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/practices/assets/main.css">
    <link href='https://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>

</head>

    <body>
        <div class="container">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <div class="row header-bar">
  <div class="col-md-8 col-sm-8">
    <h4><a class="brand" href="/practices/">Geniem Best Practices</a>
        <small>Ohjeet hyvään kehitykseen</small>
    </h4>
  </div>
  <div class="col-md-4 col-sm-4">

  </div>
</div>

                </div>
            </div>

            <div class="row">
                
                
                    <div id="navigation" class="col-sm-2">
                        <!-- Html Elements for Search -->
<div id="search-container">
  <input type="text" id="search-input" class="btn btn-default" placeholder="Etsi...">
</div>

<ul class="nav nav-list">
    <li class="nav-header">Best Practices</li>
    <li class=><a href="/practices/">Johdanto</a></li>
    <li class="divider"></li>
    
        
        

        
            

            
                
                    
                        <li class="nav-header">Kehitys</li>
                    
                    <li data-order="1"><a href="/practices/kehitys/html/">HTML</a></li>
                
            
                
                    
                    <li data-order="2"><a href="/practices/kehitys/css/">CSS</a></li>
                
            
                
                    
                    <li data-order="3"><a href="/practices/kehitys/javascript/">JavaScript</a></li>
                
            
                
                    
                    <li data-order="4"><a href="/practices/kehitys/php/">PHP</a></li>
                
            
            
                <li class="divider"></li>
            
        
    
        
        

        
            

            
                
                    
                        <li class="nav-header">Design</li>
                    
                    <li data-order="1"><a href="/practices/design/ux/">UX</a></li>
                
            
                
                    
                    <li data-order="2"><a href="/practices/design/prototyypit/">Prototyypit</a></li>
                
            
                
                    
                    <li data-order="3"><a href="/practices/design/testaus/">Testaus</a></li>
                
            
            
                <li class="divider"></li>
            
        
    
        
        

        
    
        
        

        
            

            
                
                    
                        <li class="nav-header">Projektit & työkalut</li>
                    
                    <li data-order="1"><a href="/practices/tyokalut/rakenne/">Projektin rakenne</a></li>
                
            
                
                    
                    <li data-order="2"><a href="/practices/tyokalut/kehitys/">Kehityksen työkalut</a></li>
                
            
                
                    
                    <li data-order="3"><a href="/practices/tyokalut/versionhallinta/">Versionhallinta</a></li>
                
            
                
                    
                    <li data-order="4"><a href="/practices/tyokalut/dokumentointi/">Dokumentointi</a></li>
                
            
            
        
    
    <!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>

                    </div>
                    <div id="content" class="col-sm-10">
                        <div class="page-header">
      <div class="row">
        <div class="col-md-7">
          <h1>Versionhallinta
              
          </h1>
        </div>
        <div class="col-md-5 edit-buttons">
          <a href="https://github.com/devgeniem/practices/edit/gh-pages/_posts/2016-12-09-versionhallinta.md" class="btn btn-default pull-right-md pull-left-sm">
    <i class="glyphicon glyphicon-file"></i> Muokkaa
</a>

        </div>
      </div>
</div>



<h3 id="pperiaatteet">Pääperiaatteet</h3>

<ul>
  <li>Kirjoita koodi aina johonkin omaan featurebranchiin, muuhun kuin masteriin</li>
  <li>Nimeä featurebranchit Jirataskin mukaan mikäli mahdollista.</li>
  <li>Tagaa <code class="highlighter-rouge">master</code> branch kun on todettu, että toimiva liveytys on tehty. Kirjoita lyhyt kommentti tagaukseen, jossa liveytyksen syy, päivämäärä sekä versionumero.</li>
  <li>Käytä tagauksen versionumerointiin SEMVER numerointia <a href="http://semver.org/">http://semver.org/</a> <a href="https://git-scm.com/book/en/v2/Git-Basics-Tagging">https://git-scm.com/book/en/v2/Git-Basics-Tagging</a></li>
  <li>Kaikki branchit, joissa on uniikkia koodia tulee pushata originiin. Ei säilötä mitään koodia pelkästään lokaalissa gitissä.</li>
  <li>Mikäli on tarve tehdä hotfix, tee oma hotfix branch masterista. Laita branchin nimeen <code class="highlighter-rouge">HOTFIX-yyyy-mm-dd</code> tai <code class="highlighter-rouge">HOTFIX-Jira task</code> (jos sellainen on)”. Kommentoi pushiin lyhyesti syy hotfiksille ja mitä on tehty.</li>
  <li><code class="highlighter-rouge">staging</code> branch mergetään <code class="highlighter-rouge">master</code> branchiin kun kaikki <code class="highlighter-rouge">staging</code> branchiin mergetyt feature branchit halutaan liveyttää.</li>
  <li>Mikäli <code class="highlighter-rouge">staging</code> branchista ei voida liveyttää kaikkea, masteriin tai väliaikaiseen branchiin mergetään halutut feature branchit ja ko. branch testataan dev tai stage palvelimella.</li>
</ul>

<h3 id="featurebranchit">Featurebranchit</h3>

<p>Jokaista selkeää featurekokonaisuutta varten luodaan omat branchit joissa ko. featurea kehitetään.</p>

<h3 id="lokaalit-testausbranchit">Lokaalit testausbranchit</h3>

<p>Jokainen kehittäjä voi tehdä omia testibrancheja joihin voi mergetä featurebrancheja testimielessä. Nämä branchit ovat vain testausta varten, eikä niitä pushata originiin ellei ole erityistä tarvetta mm. testauksen siirtäminen toiselle henkilölle.</p>

<h3 id="stage">Stage</h3>

<p>Tässä branchissa on versio joka on ajossa sellainen versio joka sisältää devaajien testaamia featureita joita asiakas haluaa pitää staging palvelimella.</p>

<h3 id="hotfix">Hotfix</h3>

<p>Tämä branchi kloonataan masterista ja siihen tehdään suoraan tarvittava fiksaus. Hotfix voidaan deployata staging palvelimella ja testata siellä. Kun testaus on suoritettu staging palvelin palautetaan käyttämään <code class="highlighter-rouge">stage</code> branchia. Hotfix branch mergetään <code class="highlighter-rouge">master</code> branchiin ja depoloyataan uusi <code class="highlighter-rouge">master</code> branch live palvelimelle.</p>

<h3 id="master">Master</h3>

<p><code class="highlighter-rouge">master</code> brachissa on live palvelimella kulloinkin oleva versio.</p>

<h3 id="kehitys">Kehitys</h3>

<p>Feature brancheihin kehitetään yksittäisiä featureita omalla koneella ja ne pushataan originiin. Lokaaleja testausbrancheja käytetään devauksen tukena. Nämä branchit tulee poistaa käytön jälkeen.</p>

<h3 id="testaus">Testaus</h3>

<p>Kun on tehnyt featureita joita haluaa laittaa staging-palvelimelle, hakee <code class="highlighter-rouge">staging</code> branchin omalle koneelle, johon mergettää halutut feature branchit. Tämä branch testataan devi tai stage palvelimella projektista riippuen.</p>

<p>Kun branchiin on tyytyväinen se mergetään <code class="highlighter-rouge">staging</code> branchiin. <code class="highlighter-rouge">staging</code> branchiin mergetään sellaisia feature brancheja, jotka devaaja on itse testannut ja asiakas haluaa staging palvelimelle</p>

<h3 id="code-review">Code review</h3>

<p>Projektin git-käytännöt asetetaan niin, että merge request on pakko tehdä, jos featuren haluaa asiakkaan nähtäväksi asti. Tämä taso vaihtelee projektin palvelin-/palvelu-arkkitehtuurin perusteella stagen ja tuotannon välillä.</p>

<h3 id="liveytys">Liveytys</h3>

<p>Jos todettu <code class="highlighter-rouge">staging</code> branch toimivaksi ja halutaan liveyttää se kokonaisuudessaan, mergetään se <code class="highlighter-rouge">master</code>branchiin ja deployataan.</p>

<p>Jos halutaan liveyttää vain osa <code class="highlighter-rouge">staging</code> branchissa olevista feature brancheista, mergetään <code class="highlighter-rouge">master</code> branchiin ko. feature branchit.</p>

<h3 id="workflow-esimerkki-git-kskyill">Workflow esimerkki Git-käskyillä</h3>

<p>Esimerkkiprojektiin <code class="highlighter-rouge">v1.0.0</code> halutaan uusi ominaisuus, kehittäjä on saanut jiratehtävän <code class="highlighter-rouge">TIL-123</code></p>

<p>Kehittäjä hakee esimerkkiprojektin työasemalleen <code class="highlighter-rouge">git clone git@mygitdomain.com:project/repository.git</code></p>

<p>Kehittäjä luo featurebranchin <code class="highlighter-rouge">git checkout -b TIL-123</code></p>

<p>Kehittäjä koodaa uuden ominaisuuden ja tallentaa työnsä gitlabiin</p>

<p><code class="highlighter-rouge">git add -A</code></p>

<p><code class="highlighter-rouge">git commit -m 'halutut ominaisuudet xyz'</code></p>

<p><code class="highlighter-rouge">git push origin TIL-123</code></p>

<p>Kehittäjä saa ominaisuuden valmiiksi ja yhdistää sen ```stage`` branchiin testaamista varten</p>

<p><code class="highlighter-rouge">git checkout stage</code></p>

<p><code class="highlighter-rouge">git merge TIL-123</code></p>

<p><code class="highlighter-rouge">git push origin stage</code></p>

<p>Ominaisuus deployataan staging-palvelimelle, testataan ja asiakas hyväksyy sen.</p>

<p>Kehittäjä yhdistää ominaisuuden <code class="highlighter-rouge">master</code>-branchiin</p>

<p><code class="highlighter-rouge">git checkout master</code></p>

<p><code class="highlighter-rouge">git merge TIL-123</code></p>

<p><code class="highlighter-rouge">git push origin master</code></p>

<p><code class="highlighter-rouge">master</code>-branch deployataan tuotantopalvelimelle onnistuneesti, se testataan ja hyväksytään. Kehittäjä tägää <code class="highlighter-rouge">master</code>-branchiin toimivan version</p>

<p><code class="highlighter-rouge">git tag -a v1.1.0 -m 'julkaisu ominaisuuksilla xyz 2016-04-20'</code></p>

<p><code class="highlighter-rouge">git push --follow-tags</code></p>

<h3 id="rollbackit">Rollbackit</h3>

<p>Huomataan, että esimerkkiprojektin liveytys ei olekaan hyvä, uusi ominaisuus bugaa pahasti.</p>

<p>Kehittäjä palauttaa <code class="highlighter-rouge">master</code>-branchin versioon v1.0.0</p>

<p><code class="highlighter-rouge">git reset --hard v1.0.0</code></p>



                    </div>
                    <!--googleoff: all -->
                    <div class="col-sm-10" id="search-results-box" style="display: none">
                        <div class="search-header">
                            <h1>Hakutulokset</h1>
                        </div>
                        <ul id="results-container"></ul>
                    </div>
                    <!--googleon: all -->

                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    <p>Dokumentaation projektiin <a href="https://github.com/devgeniem/practices">Best Practices</a> tuottanut <a href="http://geniem.fi/">Geniem Oy</a>.</p>

<!-- Script pointing to jekyll-search.js -->
<script src="/practices/bower_components/simple-jekyll-search/dest/jekyll-search.js" type="text/javascript"></script>
<script src="/practices/assets/main.js" type="text/javascript"></script>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
        
    </body>
</html>
